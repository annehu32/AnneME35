import uasyncio as asyncio
from machine import I2C, Pin, PWM
import neopixel
from Button import Button
from Acceleration import Acceleration

import struct
import time
import math

# Defining pins
scl = Pin('GPIO27', Pin.OUT)
sda = Pin('GPIO26', Pin.OUT)

redLight = Pin('GPIO0', Pin.OUT)
greenLight = Pin('GPIO1', Pin.OUT)
yellowLight = Pin('GPIO2',Pin.OUT)

extButton = Pin('GPIO9', Pin.IN, Pin.PULL_UP) # external button
buzzer = PWM(Pin('GPIO18', Pin.OUT))  # buzzer
neo = neopixel.NeoPixel(Pin(28), 1)   # neopixel

# Creating accelerometer and button instances
acc = Acceleration(scl, sda, greenLight)
button = Button(extButton, redLight, buzzer)

# The main code
loop = asyncio.get_event_loop()
print('loop created')
loop.create_task(button.readPress())
loop.create_task(acc.read_event())
loop.run_forever()
    
